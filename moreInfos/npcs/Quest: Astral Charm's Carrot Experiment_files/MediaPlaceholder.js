
(function($,window){var MediaPlaceholder={init:function(){if(this.loaded){return;}
this.loaded=true;this.imageLoaded=false;this.WikiaArticle=$('#WikiaArticle');if($.getUrlVar('diff')||$.getUrlVar('oldid')){return false;}
var self=this;this.setupVideoPlaceholders();$('#WikiaArticle').on('click','.wikiaPlaceholder a',function(e){var $this=$(this);if($this.parent().parent().hasClass('wikiaVideoPlaceholder')){return;}
e.preventDefault();var oText=$this.text();$this.startThrobbing();var props=self.getProps($this);if(!self.imageLoaded){$.when($.getResources([$.loadYUI,$.loadJQueryAIM,$.getSassCommonURL('extensions/wikia/WikiaMiniUpload/css/WMU.scss'),wgResourceBasePath+'/extensions/wikia/WikiaMiniUpload/js/WMU.js'])).done(function(){self.imageLoaded=true;$this.text(oText);window.WMU_show(self.getEvent(),-2,props.placeholderIndex,props.align,props.thumb,props.width,props.caption,props.link);});}else{$this.text(oText);window.WMU_show(self.getEvent(),-2,props.placeholderIndex,props.align,props.thumb,props.width,props.caption,props.link);}});},setupVideoPlaceholders:function(){var self=this;self.WikiaArticle.find('.wikiaVideoPlaceholder a').each(function(){var $this=$(this),props=self.getProps($this);$this.addVideoButton({embedPresets:props,insertFinalVideoParams:['placeholder=1','box='+props.placeholderIndex,'article='+encodeURIComponent(wgTitle),'ns='+wgNamespaceNumber],callbackAfterEmbed:self.videoEmbedCallback});});},videoEmbedCallback:function(embedData){var placeholders=MediaPlaceholder.WikiaArticle.find('.wikiaVideoPlaceholder a'),to_update=placeholders.filter('[data-id='+embedData.placeholderIndex+']'),html=$('#VideoEmbedCode').html();to_update.parent().parent().replaceWith(html);placeholders.each(function(){var $this=$(this),id=$this.attr('data-id');if(id>embedData.placeholderIndex){$this.attr('data-id',id-1);}});$.post(wgScript,{title:wgPageName,action:'purge'});MediaPlaceholder.setupVideoPlaceholders();},getProps:function(elem){return{placeholderIndex:elem.attr('data-id'),align:elem.attr('data-align'),width:elem.attr('data-width'),thumb:elem.attr('data-thumb'),link:elem.attr('data-link'),caption:elem.attr('data-caption')}},getEvent:function(e,boundEl){var ev=e||window.event;if(!ev){var c=this.getEvent.caller;while(c){ev=c.arguments[0];if(ev&&Event==ev.constructor){break;}
c=c.caller;}}
return ev;}};window.MediaPlaceholder=MediaPlaceholder;})(jQuery,this);